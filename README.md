# Telegram Contacts Export

Экспорт контактов и чатов из Telegram с возможностью сверки по файлу никнеймов.

## Быстрый старт

### 1. Получение API ключей

1. Идите на https://my.telegram.org
2. Войдите с номером телефона
3. Перейдите в "API development tools"
4. Создайте приложение (любое название)
5. Скопируйте `api_id` и `api_hash`

### 2. Установка

```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# или
venv\Scripts\activate     # Windows

pip install -r requirements.txt
```

### 3. Запуск

```bash
python main.py
```

## Использование

1. **Настройка** - введите `api_id`, `api_hash` и номер телефона
2. **Экспорт контактов** - сохраняет все контакты в CSV/JSON
3. **Экспорт чатов** - сохраняет диалоги с пользователями
4. **Экспорт всего** - контакты + чаты
5. **Сверка с nicknames.txt** - находит совпадения по никнеймам

## Файлы результатов

- `telegram_contacts.csv/json` - экспорт контактов
- `telegram_chats.csv/json` - экспорт чатов  
- `telegram_nicknames_matches.csv/json` - найденные совпадения

## Сверка никнеймов

Создайте файл `nicknames.txt` с никнеймами (по одному на строку без @ собачек):
```
nickname1
nickname2
username_example
```

Программа найдет совпадения среди ваших контактов и чатов.

## Разработка

### Тестирование

Проект использует pytest с минимальным набором тестов:

```bash
# Все тесты
pytest

# Только быстрые тесты (без интеграционных)
pytest -m "not integration"

# Только интеграционные тесты  
pytest -m integration

# Параллельное выполнение (если нужна скорость)
pytest -n auto

# С покрытием кода
pytest --cov=src
```

### Линтинг и форматирование

```bash
# Проверка кода
ruff check .

# Исправление проблем
ruff check . --fix

# Форматирование кода
ruff format .
```

### VS Code

Проект настроен для работы с VS Code:
- Автоматическое обнаружение тестов pytest
- Автоформатирование Ruff при сохранении файла
- Линтинг и исправление ошибок на лету
- Запуск и отладка через F5
- Задачи: `Ctrl+Shift+P` → "Tasks: Run Task"
  - "Run Tests" - все тесты
  - "Run Tests (Fast)" - быстрые тесты без интеграционных
  - "Run Integration Tests" - только интеграционные

## Структура проекта

```
├── src/                    # Исходный код
│   ├── config.py          # Конфигурация
│   ├── session_manager.py # Управление сессиями
│   ├── file_manager.py    # Работа с файлами
│   ├── menu_manager.py    # Интерфейс меню
│   ├── telegram_client_wrapper.py  # Telegram API
│   └── telegram_exporter.py        # Основной класс
├── tests/                  # Минимальный набор тестов
├── sessions/              # Файлы сессий (мультисессии)
├── exports/               # Экспортированные данные (по сессиям)
├── main.py               # Точка входа
└── pyproject.toml        # Конфигурация pytest и ruff
```

## Примечания

- Сессии сохраняются в папке `sessions/`
- Поддержка нескольких аккаунтов
- Прогресс сохраняется при прерывании
- Данные изолированы по сессиям